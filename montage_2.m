%**************************************************************************
% Sujet TP électronique analogique
% Date :
% Séance :14/3
%**************************************************************************
clear all;
close all;
clc;
%***************************
% Constantes du circuit
Vcc = 10;
VGSoff = -2.723;
Idss = 7.57e-3;
Rg = 2.2e6;
Id0 = 1e-3;
Vds = Vcc/2 ;

%**************************************************************************
% Dimensionnement du circuit
VGs = VGSoff * (1 - sqrt(Id0/Idss));
Rs  = (-VGs)/Id0 ;
Vrd = Vcc - Vds - (-VGs);
Rd = Vrd / Id0;
g_m = (-2)*Idss/VGSoff * (1 - VGs/VGSoff);



%**************************************************************************
subplot(2,2,2);
plot([0 Vcc],[Vcc*1e3/(Rs+Rd) 0],'r');
grid on;
xlabel('Vds (V)'),ylabel('Id (mA)');
%vpp = 5v sans charge;
subplot(2,2,1);
fre =   [2      5     10    20    30       40    50    100   200   500    1e3   5e3    10e3    100e3  500e3  1000e3 2000e3   ];
Ve0 =   [0.0584 0.124 0.172 0.2  0.204    0.208 0.212 0.212 0.212 0.212  0.212 0.224  0.224   0.228  0.228  0.228  0.224   ];
Vs0 =   [0.18   0.624 1.12  1.36 1.44     1.48  1.5   1.52  1.52  1.52   1.52  1.54   1.54    1.58   1.3    0.94   0.56   ];

Av = 20*log10(Vs0./Ve0);
semilogx(fre,Av);
grid on;
hold on;
fre =   [2      5     10     20       100   200    500    1e3    5e3     10e3    100e3  500e3  1000e3 2000e3   ];
Ve =    [0.0592 0.12  0.17   0.196    0.212 0.212  0.212  0.212  0.216   0.224   0.228  0.228  0.228  0.224   ];
Vs =    [0.0424 0.156 0.268  0.332    0.364 0.368  0.368  0.368  0.368   0.384   0.392  0.376  0.36   0.308   ];
Av = 20*log10(Vs./Ve);
grid on;
semilogx(fre,Av);
